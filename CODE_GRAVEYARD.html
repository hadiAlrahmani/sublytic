

<!--  ! CODY GRAVEYARD -->
 <!-- from celery import shared_task

 @shared_task
 def test_task():
     print("Celery is working!")
     return "Hello from Celery"

     # This will print the email to the console instead of actually sending it. You should see the email content printed when the Celery task is executed.
     # EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'
     #login failed
     # EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
     # EMAIL_HOST = 'smtp.gmail.com'
     # EMAIL_PORT = 587
     # EMAIL_USE_TLS = True
     # EMAIL_HOST_USER = '-@gmail.com'  
     # EMAIL_HOST_PASSWORD = '-' 
     # DEFAULT_FROM_EMAIL = 'noreply@sublytic.com'

  status: updated 26325 - Hadi

     {% if subscription.renewal_date <= today %} - 1 day for renewal reminder in the card - subscription_list.
     
       <hr>
  <h3>Past Subscription Payments</h3>
  <a href="{% url 'subscription_history' %}">View Payment History</a>


  @admin.register(SubscriptionPayment)
class SubscriptionPaymentAdmin(admin.ModelAdmin):
    list_display = ('id', 'subscription', 'amount', 'payment_date')
    search_fields = ('subscription__user__username', 'subscription__predefined_subscription__name')

    from .models import Subscription, SubscriptionPayment, PredefinedSubscription

    LOGIN_REDIRECT_URL = '/subscriptions/'

    old task 

    from celery import shared_task
from django.core.mail import send_mail
from django.utils.timezone import now, timedelta
from .models import Subscription

@shared_task
def send_subscription_reminders():
    today = now().date()
    upcoming_subscriptions = Subscription.objects.filter(renewal_date=today + timedelta(days=2))

    # Log the upcoming subscriptions
    print(f"Upcoming subscriptions: {upcoming_subscriptions}")

    for subscription in upcoming_subscriptions:
        user_email = subscription.user.email
        send_mail(
            subject="Subscription Renewal Reminder",
            message=f"Your {subscription.predefined_subscription.name} subscription will renew on {subscription.renewal_date}.",
            from_email="noreply@sublytic.com",
            recipient_list=[user_email],
        )

    return f"Sent {upcoming_subscriptions.count()} reminders"
   
   
    # CELERY_BEAT_SCHEDULE = {
#     'send_subscription_reminders_daily': {
#         'task': 'main_app.tasks.send_subscription_reminders',
#         'schedule': 86400.0,  # Runs every 24 hours
#     },
# }
   
    -->

    <!-- # DATABASES = {
        #     'default': {
        #         'ENGINE': 'django.db.backends.postgresql',
        #         'NAME': 'sublytic_db',
        #         'USER': 'itshidden',
        #         'PASSWORD': 'Pp@123456',
        #         'HOST': 'localhost',
        #         'PORT': '5432',
        #     }
        # }

# Password validation
# https://docs.djangoproject.com/en/5.1/ref/settings/#auth-password-validators


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.1/howto/deployment/checklist/

# Build paths inside the project like this: BASE_DIR / 'subdir'.

# SECURITY WARNING: don't run with debug turned on in production!
# Application definition

# Database
# https://docs.djangoproject.com/en/5.1/ref/settings/#databases


# Internationalization
# https://docs.djangoproject.com/en/5.1/topics/i18n/


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/5.1/howto/static-files/


# Default primary key field type
# https://docs.djangoproject.com/en/5.1/ref/settings/#default-auto-field


         -->